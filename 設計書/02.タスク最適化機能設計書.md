# タスク優先順位付け機能設計書

## 為したい要件

- 各タスクの優先順位を決定する  

### いつ

- 予定表自動作成機能実行時  
　　
### なにを

- タスクの優先順位をつける  
- 優先順位は 重要度、期限、残り所要時間(進捗を使って出す)によって決める  

#### 優先順位づけの決め方の理想

- すべてのタスクが期限までに終わらせられる(期限を早めに設定してもらうことで期限までの余裕を持たせる)  
- できるだけ優先順位が高いタスクを先に消化していきたい  

#### 優先順位づけの決め方関数

以下最適化を実施する  
(TODO: 最適化関数の整理は次回実施)  
以下はタスクが全てこなせるときに最大化できない。  
重要度が高いタスクを早くやれることに対して重みづけが必要。  

完了予定日＝＞期限  のとき(2週間先までが期限の全タスクの所要時間が2週間の使用可能時間より短いときと、期限が短いものから順にタスクを消化したときに期限に間に合わないタスクが発生するとき)  
ユーザーにタスク間に合わないですよ、表示(マイナス何時間みたいな？)


完了予定日＜＝期限  のとき
max  Σ XY  
※X  優先順位と他の人に影響するかの組み合わせ重み付け    (12倍～1倍)  
※Y  各タスクの消化時間  

効用関数  
優先順位高いモノから消化されること  


メモ
　１優先順位を計算
　２優先順位順に予定を登録する
　３また、入力可能な時間に合わせてスケジュール登録を行う
　４予定までに終わらせるために、
　　優先順位の計算に重みとして期限を反映
　　制約条件として別に計算式を作成

## 処理の流れ

1. SQLでDBから以下を取得する  

- 該当ユーザーの2週間1日毎の対応可能時間  
- 該当ユーザーの期限が2週間先までの小項目タスク一覧  

2 . 優先順位づけの決め方関数に渡す  

## エラー出力

- DB値なし  
- DBエラー  
- SQLから取得したデータが正しいデータではない  
- タスク最適化エラー(仮置き、計算式が決まったタイミングで精緻化する)  

## 使用データ項目

1. 該当ユーザーの2週間1日毎の対応可能時間  
日にち、対応可能時間のセット  

2. 該当ユーザーの小項目タスク一覧  
小項目タスクID、期限、優先順位、タスクの所要時間のセット  

### input（必要なデータ）

- 該当ユーザーID  
- 実行日  

### output（出力するデータ）

- 優先順位づけのタスク一覧  

## 処理の流れの決定背景

### 該当ユーザーの小項目タスク一覧のみとした理由

前提として大項目、中項目を完了させるためのタスクが小項目に全てあると想定した。大項目を考えると複雑化する。  

### 期限が2週間先までのタスク一覧にしぼった理由

2週間のスケジュールで空きがでる場合は空きがでると表現したいから。  
オプションでいつまでのタスクまでを対象とするかは決めてもいいかも。  

### 他の人に影響するかを削った理由

重要度、期限で置き換え可能のため。  